<div class="container">
    <div class="top">
        <img src="/assets/icons/warlok-icon.svg" width="24" srcset="">
        <h1>Login</h1>
    </div>
    <div class="middle">
        <form action="/login" method="post" id="formData">
            <label for="username">Username:</label>
            <input required autocomplete="off" type="text" name="username" id="username" placeholder="Username atau Nomor Telepon">
            <label for="password">Password:</label>
            <input required autocomplete="off" type="password" name="password" id="password" placeholder="Password">
            <div class="checkPasswd">
                <input type="checkbox" name="hidePasswd" id="hidePasswd" style="margin-right: 7px;">
                <label for="hidePasswd" style="transform: translateY(1px);">Show password</label>
            </div>
            <button style="display: block; width: 100%;margin-top: 15px;" type="submit" class="" id="formBtn">Login</button>
        </form>
    </div>
    <div class="bottom"> 
        <p>Lupa <a href="/forgot">username/password?</a></p>
        <p>Belum punya akun? <a href="/register">Register</a></p>
    </div>
</div>
<script>
    const form = document.getElementById("formData");
    const formBtn = document.getElementById("formBtn");
    const hidePasswd = document.getElementById("hidePasswd");
    const passwd = document.getElementById("password");

    hidePasswd.addEventListener('click', () => {
        if(passwd.type == "password"){
            passwd.type = "text";
        } else {
            passwd.type = "password";
        }
    });

    form.addEventListener("submit",async (e) => {
        e.preventDefault();
        console.log("hehe");
        const formData = new FormData(form);
        const data = {
            username: formData.get("username"),
            password: formData.get("password"),
        }

        const response = await fetch('/login', {
            method: 'POST',
            headers: {'Content-Type':'application/json'},
            body: JSON.stringify(data)
        });
        const result = await response.json();
        if(result.success){
            window.location.href = "/beranda";
            console.log("susah coy")
        } 
        else {
            console.log(result);
        }
    });

</script>
